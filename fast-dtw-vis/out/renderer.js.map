{"version":3,"sources":["src/app/index.tsx","src/app/root-component.tsx","src/app/components/ImagePair.tsx","src/app/components/FileImage.tsx","src/app/lib/Image.ts"],"names":[],"mappings":";;;;;;;AAAA,+BAA8B;AAC9B,sCAAqC;AACrC,qDAAgD;AAChD,uCAAmC;AACnC,mCAA4B;AAE5B,wBAAqB;AAErB,YAAG,CAAC,MAAM,CAAC,YAAY,EAAE;IACvB,SAAS,EAAE,MAAM;IACjB,MAAM,EAAE,SAAS;IACjB,IAAI,EAAE,SAAS;IACf,mBAAmB,EAAE,sBAAsB;IAC3C,aAAa,EAAE,qBAAqB;CACrC,CAAC,CAAA;AAEF,mBAAQ,CAAC,wBAAwB,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA;AAEvC,QAAQ,CAAC,gBAAgB,CAAC,UAAU,EAAE,CAAC,KAAK,EAAE,EAAE,CAAC,KAAK,CAAC,cAAc,EAAE,CAAC,CAAA;AACxE,QAAQ,CAAC,gBAAgB,CAAC,MAAM,EAAE,CAAC,KAAK,EAAE,EAAE,CAAC,KAAK,CAAC,cAAc,EAAE,CAAC,CAAA;AAEpE,QAAQ,CAAC,MAAM,CAAC,oBAAC,8BAAa,OAAG,EAAE,QAAQ,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC,CAAA;;;;;;;;ACrBnE,+BAA8B;AAC9B,sDAA8C;AAE9C,MAAa,aAAc,SAAQ,KAAK,CAAC,SAAiB;IACxD,MAAM;QACJ,OAAO,CACL;YACE,oBAAC,mBAAS,OAAG,CACT,CACP,CAAA;IACH,CAAC;CACF;AARD,sCAQC;;;;;;;ACXD,+BAA8B;AAC9B,2CAAmC;AAGnC,MAAM,cAAc;CAAG;AACvB,MAAM,cAAc;CAInB;AAED,MAAqB,SAAU,SAAQ,KAAK,CAAC,SAG5C;IACC,YAAY,KAAqB;QAC/B,KAAK,CAAC,KAAK,CAAC,CAAA;QAEZ,IAAI,CAAC,KAAK,GAAG;YACX,MAAM,EAAE,IAAI;YACZ,MAAM,EAAE,IAAI;YACZ,aAAa,EAAE,QAAQ;SACxB,CAAA;IACH,CAAC;IAED,SAAS,CAAC,KAAY;QACpB,IAAI,CAAC,QAAQ,CAAC,EAAE,MAAM,EAAE,KAAK,EAAE,CAAC,CAAA;IAClC,CAAC;IAED,SAAS,CAAC,KAAY;QACpB,IAAI,CAAC,QAAQ,CAAC,EAAE,MAAM,EAAE,KAAK,EAAE,CAAC,CAAA;IAClC,CAAC;IAED,mBAAmB;QACjB,IAAI,IAAI,CAAC,KAAK,CAAC,aAAa,KAAK,QAAQ,EAAE;YACzC,IAAI,CAAC,QAAQ,CAAC,EAAE,aAAa,EAAE,QAAQ,EAAE,CAAC,CAAA;SAC3C;aAAM;YACL,IAAI,CAAC,QAAQ,CAAC,EAAE,aAAa,EAAE,QAAQ,EAAE,CAAC,CAAA;SAC3C;IACH,CAAC;IAED,MAAM;;QACJ,OAAO,CACL;YACE,oBAAC,mBAAS,IAAC,aAAa,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,GAAI;YAC1D,oBAAC,mBAAS,IAAC,aAAa,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,GAAI;YAE1D;6CAEG,IAAI,CAAC,KAAK,CAAC,MAAM;mBAAE,KAAK;2BAAG,IAAI,CAAC,KAAK,CAAC,MAAM;mBAAE,MAAM,CACjD;YACN;6CAEG,IAAI,CAAC,KAAK,CAAC,MAAM;mBAAE,KAAK;2BAAG,IAAI,CAAC,KAAK,CAAC,MAAM;mBAAE,MAAM,CACjD;YAEN,gCAAQ,OAAO,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,mBAAmB,EAAE;;gBAC9B,IAAI,CAAC,KAAK,CAAC,aAAa,CAClC,CACR,CACJ,CAAA;IACH,CAAC;CACF;AAnDD,4BAmDC;;;;;;;;;;;;;;;;AC9DD,+BAA8B;AAC9B,uCAAiC;AACjC,wCAAgC;AAChC,2CAA2C;AAE3C,MAAM,cAAc;CAEnB;AAED,MAAM,cAAc;CAKnB;AAED,MAAqB,SAAU,SAAQ,KAAK,CAAC,SAG5C;IACC,YAAY,KAAqB;QAC/B,KAAK,CAAC,KAAK,CAAC,CAAA;QAEZ,IAAI,CAAC,KAAK,GAAG;YACX,QAAQ,EAAE,IAAI;YACd,KAAK,EAAE,IAAI;YACX,OAAO,EAAE,KAAK;SACf,CAAA;IACH,CAAC;IAEK,cAAc;;YAClB,MAAM,MAAM,GAAG,MAAM,iBAAM,CAAC,MAAM,CAAC,cAAc,CAAC;gBAChD,UAAU,EAAE,CAAC,UAAU,CAAC;aACzB,CAAC,CAAA;YAEF,IAAI,MAAM,CAAC,QAAQ;gBAAE,OAAM;YAC3B,IAAI,MAAM,CAAC,SAAS,CAAC,MAAM,KAAK,CAAC;gBAAE,OAAM;YAEzC,MAAM,QAAQ,GAAG,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC,CAAA;YAEpC,IAAI,CAAC,QAAQ,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAA;YAEhC,IAAI,CAAC,WAAW,EAAE,CAAA;YAElB,IAAI;gBACF,IAAI,CAAC,QAAQ,CAAC;oBACZ,QAAQ;oBACR,KAAK,EAAE,MAAM,eAAK,CAAC,YAAY,CAAC,QAAQ,CAAC;iBAC1C,CAAC,CAAA;gBACF,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAA;aAC3C;YAAC,OAAO,CAAC,EAAE;gBACV,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;gBACd,IAAI,CAAC,QAAQ,CAAC;oBACZ,KAAK,EAAE,CAAC,CAAC,OAAO;iBACjB,CAAC,CAAA;aACH;oBAAS;gBACR,IAAI,CAAC,QAAQ,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC,CAAA;aAClC;QACH,CAAC;KAAA;IAED,MAAM;QACJ,OAAO,CACL;YACE,gCAAQ,OAAO,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,cAAc,EAAE,kBAAsB;YAClE,kCAAO,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,EAAE,CAAQ;YACrD,kCAAO,IAAI,CAAC,KAAK,CAAC,KAAK,CAAQ;YAC/B,6BAAK,KAAK,EAAC,KAAK,EAAC,GAAG,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAI,CACzC,CACP,CAAA;IACH,CAAC;CACF;AAtDD,4BAsDC;;;;;;;;;;;;;;;;ACtED,6BAA4B;AAE5B,MAAqB,KAAK;IACxB,YACS,MAAc,EACd,KAAa,EACb,QAAoB,EACpB,MAAc;QAHd,WAAM,GAAN,MAAM,CAAQ;QACd,UAAK,GAAL,KAAK,CAAQ;QACb,aAAQ,GAAR,QAAQ,CAAY;QACpB,WAAM,GAAN,MAAM,CAAQ;IACpB,CAAC;IAEJ,MAAM,CAAO,YAAY,CAAC,QAAgB;;YACxC,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;YAEtC,IAAI,KAAK,GAAG,IAAI,UAAU,CAAC,IAAI,CAAC,SAAS,EAAE,GAAG,IAAI,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC,CAAA;YAElE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,SAAS,EAAE,EAAE,EAAE,CAAC,EAAE;gBACzC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,QAAQ,EAAE,EAAE,EAAE,CAAC,EAAE;oBACxC,IAAI,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAA;oBACnD,IAAI,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,SAAS,EAAE,GAAG,CAAC,GAAG,CAAC,CAAA;oBACpC,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAA;oBACjB,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAA;oBACrB,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAA;iBACtB;aACF;YAED,OAAO,IAAI,KAAK,CACd,IAAI,CAAC,SAAS,EAAE,EAChB,IAAI,CAAC,QAAQ,EAAE,EACf,KAAK,EACL,MAAM,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,CAC1C,CAAA;QACH,CAAC;KAAA;CACF;AA9BD,wBA8BC","file":"","sourcesContent":["import * as React from \"react\"\r\nimport * as ReactDOM from \"react-dom\"\r\nimport { RootComponent } from \"./root-component\"\r\nimport { webFrame } from \"electron\"\r\nimport { css } from \"glamor\"\r\n\r\nimport \"glamor/reset\"\r\n\r\ncss.global(\"html, body\", {\r\n  useSelect: \"none\",\r\n  cursor: \"default\",\r\n  font: \"caption\",\r\n  WebkitFontSmoothing: \"subpixel-antialiased\",\r\n  textRendering: \"optimize-legibility\",\r\n})\r\n\r\nwebFrame.setVisualZoomLevelLimits(1, 1)\r\n\r\ndocument.addEventListener(\"dragover\", (event) => event.preventDefault())\r\ndocument.addEventListener(\"drop\", (event) => event.preventDefault())\r\n\r\nReactDOM.render(<RootComponent />, document.getElementById(\"root\"))\r\n","import * as React from \"react\"\r\nimport ImagePair from \"./components/ImagePair\"\r\n\r\nexport class RootComponent extends React.Component<{}, {}> {\r\n  render() {\r\n    return (\r\n      <div>\r\n        <ImagePair />\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","import * as React from \"react\"\r\nimport FileImage from \"./FileImage\"\r\nimport Image from \"../lib/Image\"\r\n\r\nclass ImagePairProps {}\r\nclass ImagePairState {\r\n  image1?: Image\r\n  image2?: Image\r\n  warpDirection: \"1-to-2\" | \"2-to-1\"\r\n}\r\n\r\nexport default class ImagePair extends React.Component<\r\n  ImagePairProps,\r\n  ImagePairState\r\n> {\r\n  constructor(props: ImagePairProps) {\r\n    super(props)\r\n\r\n    this.state = {\r\n      image1: null,\r\n      image2: null,\r\n      warpDirection: \"1-to-2\",\r\n    }\r\n  }\r\n\r\n  setImage1(image: Image) {\r\n    this.setState({ image1: image })\r\n  }\r\n\r\n  setImage2(image: Image) {\r\n    this.setState({ image2: image })\r\n  }\r\n\r\n  toggleWarpDirection() {\r\n    if (this.state.warpDirection === \"1-to-2\") {\r\n      this.setState({ warpDirection: \"2-to-1\" })\r\n    } else {\r\n      this.setState({ warpDirection: \"1-to-2\" })\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <FileImage onImageChange={(img) => this.setImage1(img)} />\r\n        <FileImage onImageChange={(img) => this.setImage2(img)} />\r\n\r\n        <div>\r\n          Image 1 dimensions:\r\n          {this.state.image1?.width}x{this.state.image1?.height}\r\n        </div>\r\n        <div>\r\n          Image 2 dimensions:\r\n          {this.state.image2?.width}x{this.state.image2?.height}\r\n        </div>\r\n\r\n        <button onClick={() => this.toggleWarpDirection()}>\r\n          Warp direction: {this.state.warpDirection}\r\n        </button>\r\n      </>\r\n    )\r\n  }\r\n}\r\n","import * as React from \"react\"\r\nimport { remote } from \"electron\"\r\nimport Image from \"../lib/Image\"\r\n//const remote = require(\"electron\").remote\r\n\r\nclass FileImageProps {\r\n  onImageChange: (image: Image) => void\r\n}\r\n\r\nclass FileImageState {\r\n  filepath?: string\r\n  image?: Image\r\n  loading: boolean\r\n  error?: string\r\n}\r\n\r\nexport default class FileImage extends React.Component<\r\n  FileImageProps,\r\n  FileImageState\r\n> {\r\n  constructor(props: FileImageProps) {\r\n    super(props)\r\n\r\n    this.state = {\r\n      filepath: null,\r\n      image: null,\r\n      loading: false,\r\n    }\r\n  }\r\n\r\n  async showFileDialog() {\r\n    const result = await remote.dialog.showOpenDialog({\r\n      properties: [\"openFile\"],\r\n    })\r\n\r\n    if (result.canceled) return\r\n    if (result.filePaths.length === 0) return\r\n\r\n    const filepath = result.filePaths[0]\r\n\r\n    this.setState({ loading: true })\r\n\r\n    this.forceUpdate()\r\n\r\n    try {\r\n      this.setState({\r\n        filepath,\r\n        image: await Image.loadFromFile(filepath),\r\n      })\r\n      this.props.onImageChange(this.state.image)\r\n    } catch (e) {\r\n      console.log(e)\r\n      this.setState({\r\n        error: e.message,\r\n      })\r\n    } finally {\r\n      this.setState({ loading: false })\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <button onClick={() => this.showFileDialog()}>Upload file</button>\r\n        <span>{this.state.loading ? \"loading...\" : \"\"}</span>\r\n        <span>{this.state.error}</span>\r\n        <img width=\"50%\" src={this.state.filepath} />\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","import * as Jimp from \"jimp\"\r\n\r\nexport default class Image {\r\n  private constructor(\r\n    public height: number,\r\n    public width: number,\r\n    public rawBytes: Uint8Array,\r\n    public base64: string\r\n  ) {}\r\n\r\n  static async loadFromFile(filepath: string): Promise<Image> {\r\n    const file = await Jimp.read(filepath)\r\n\r\n    let bytes = new Uint8Array(file.getHeight() * file.getWidth() * 3)\r\n\r\n    for (let y = 0; y < file.getHeight(); ++y) {\r\n      for (let x = 0; x < file.getWidth(); ++x) {\r\n        let rgba = Jimp.intToRGBA(file.getPixelColor(x, y))\r\n        let i = y * file.getHeight() + x * 3\r\n        bytes[i] = rgba.r\r\n        bytes[i + 1] = rgba.g\r\n        bytes[i + 2] = rgba.b\r\n      }\r\n    }\r\n\r\n    return new Image(\r\n      file.getHeight(),\r\n      file.getWidth(),\r\n      bytes,\r\n      await file.getBase64Async(file.getMIME())\r\n    )\r\n  }\r\n}\r\n"]}